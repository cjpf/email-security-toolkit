# test-ciphers
Check the supported cipher suite for the targeted server, protocol dynamically selected based on port. This tool is very helpful for both security auditing/hardening as well as diagnosing compatibility issues with STARTTLS-based services.

If you want to shadow this output to another file, use the "tee" command like so:
`./test_ciphers_dynamic.sh server:port | tee "outfile"`

## TODO
Miscellaneous things to improve upon in this tool.
+ [ ] **COMPLETE OVERHAUL** -- Since this script was just sort of 'appended' to this toolkit, it needs to be better-embraced and conform to the way the other tools display their output and process information.
+ [ ] Generate a report of _only_ either supported or unsupported cipher suites, with a command-line parameter. Something like `-u filename` for a list of unsupported ciphers, or `-U filename` for supported ciphers, output into `filename`.
+ [ ] Test a specific cipher or protocol suite via command-line option.
+ [ ] Option to generate a CSV indicating support or lack of support for each cipher. Something in a format like `cipher,[supported,unsupported]`. This would do wonders for automating reports.

## Sample Bash Output
```
~ $ ./test-ciphers.sh misc.testserver.email:25 -n | tee test.tmp
Checking supported ciphers for: misc.testserver.email:25
Obtaining cipher list from OpenSSL 1.0.2k-fips  26 Jan 2017...
Test type is SMTP with STARTTLS!
Testing ECDHE-RSA-AES256-GCM-SHA384... YES (TLSv1.2)
Testing ECDHE-ECDSA-AES256-GCM-SHA384... NO (sslv3 alert handshake failure)
Testing ECDHE-RSA-AES256-SHA384... YES (TLSv1.2)
Testing ECDHE-ECDSA-AES256-SHA384... NO (sslv3 alert handshake failure)
Testing ECDHE-RSA-AES256-SHA... NO (sslv3 alert handshake failure)
Testing ECDHE-ECDSA-AES256-SHA... NO (sslv3 alert handshake failure)
Testing DH-DSS-AES256-GCM-SHA384... NO (sslv3 alert handshake failure)
Testing DHE-DSS-AES256-GCM-SHA384... NO (sslv3 alert handshake failure)
Testing DH-RSA-AES256-GCM-SHA384... NO (sslv3 alert handshake failure)
Testing DHE-RSA-AES256-GCM-SHA384... YES (TLSv1.2)
Testing DHE-RSA-AES256-SHA256... YES (TLSv1.2)
Testing DHE-DSS-AES256-SHA256... NO (sslv3 alert handshake failure)
Testing DH-RSA-AES256-SHA256... NO (sslv3 alert handshake failure)
Testing DH-DSS-AES256-SHA256... NO (sslv3 alert handshake failure)
Testing DHE-RSA-AES256-SHA... NO (sslv3 alert handshake failure)
Testing DHE-DSS-AES256-SHA... NO (sslv3 alert handshake failure)
Testing DH-RSA-AES256-SHA... NO (sslv3 alert handshake failure)
Testing DH-DSS-AES256-SHA... NO (sslv3 alert handshake failure)
Testing DHE-RSA-CAMELLIA256-SHA... NO (sslv3 alert handshake failure)
Testing DHE-DSS-CAMELLIA256-SHA... NO (sslv3 alert handshake failure)
Testing DH-RSA-CAMELLIA256-SHA... NO (sslv3 alert handshake failure)
Testing DH-DSS-CAMELLIA256-SHA... NO (sslv3 alert handshake failure)
Testing AECDH-AES256-SHA... NO (sslv3 alert handshake failure)
Testing ADH-AES256-GCM-SHA384... NO (sslv3 alert handshake failure)
Testing ADH-AES256-SHA256... NO (sslv3 alert handshake failure)
Testing ADH-AES256-SHA... NO (sslv3 alert handshake failure)
Testing ADH-CAMELLIA256-SHA... NO (sslv3 alert handshake failure)
Testing ECDH-RSA-AES256-GCM-SHA384... NO (sslv3 alert handshake failure)
Testing ECDH-ECDSA-AES256-GCM-SHA384... NO (sslv3 alert handshake failure)
Testing ECDH-RSA-AES256-SHA384... NO (sslv3 alert handshake failure)
Testing ECDH-ECDSA-AES256-SHA384... NO (sslv3 alert handshake failure)
Testing ECDH-RSA-AES256-SHA... NO (sslv3 alert handshake failure)
Testing ECDH-ECDSA-AES256-SHA... NO (sslv3 alert handshake failure)
Testing AES256-GCM-SHA384... YES (TLSv1.2)
Testing AES256-SHA256... NO (sslv3 alert handshake failure)
Testing AES256-SHA... NO (sslv3 alert handshake failure)
Testing CAMELLIA256-SHA... NO (sslv3 alert handshake failure)
Testing PSK-AES256-CBC-SHA... NO (no ciphers available)
Testing ECDHE-RSA-AES128-GCM-SHA256... NO (sslv3 alert handshake failure)
Testing ECDHE-ECDSA-AES128-GCM-SHA256... NO (sslv3 alert handshake failure)
Testing ECDHE-RSA-AES128-SHA256... NO (sslv3 alert handshake failure)
Testing ECDHE-ECDSA-AES128-SHA256... NO (sslv3 alert handshake failure)
Testing ECDHE-RSA-AES128-SHA... NO (sslv3 alert handshake failure)
Testing ECDHE-ECDSA-AES128-SHA... NO (sslv3 alert handshake failure)
Testing DH-DSS-AES128-GCM-SHA256... NO (sslv3 alert handshake failure)
Testing DHE-DSS-AES128-GCM-SHA256... NO (sslv3 alert handshake failure)
Testing DH-RSA-AES128-GCM-SHA256... NO (sslv3 alert handshake failure)
Testing DHE-RSA-AES128-GCM-SHA256... NO (sslv3 alert handshake failure)
Testing DHE-RSA-AES128-SHA256... NO (sslv3 alert handshake failure)
Testing DHE-DSS-AES128-SHA256... NO (sslv3 alert handshake failure)
Testing DH-RSA-AES128-SHA256... NO (sslv3 alert handshake failure)
Testing DH-DSS-AES128-SHA256... NO (sslv3 alert handshake failure)
Testing DHE-RSA-AES128-SHA... NO (sslv3 alert handshake failure)
Testing DHE-DSS-AES128-SHA... NO (sslv3 alert handshake failure)
Testing DH-RSA-AES128-SHA... NO (sslv3 alert handshake failure)
Testing DH-DSS-AES128-SHA... NO (sslv3 alert handshake failure)
Testing DHE-RSA-SEED-SHA... NO (sslv3 alert handshake failure)
Testing DHE-DSS-SEED-SHA... NO (sslv3 alert handshake failure)
Testing DH-RSA-SEED-SHA... NO (sslv3 alert handshake failure)
Testing DH-DSS-SEED-SHA... NO (sslv3 alert handshake failure)
Testing DHE-RSA-CAMELLIA128-SHA... NO (sslv3 alert handshake failure)
Testing DHE-DSS-CAMELLIA128-SHA... NO (sslv3 alert handshake failure)
Testing DH-RSA-CAMELLIA128-SHA... NO (sslv3 alert handshake failure)
Testing DH-DSS-CAMELLIA128-SHA... NO (sslv3 alert handshake failure)
Testing AECDH-AES128-SHA... NO (sslv3 alert handshake failure)
Testing ADH-AES128-GCM-SHA256... NO (sslv3 alert handshake failure)
Testing ADH-AES128-SHA256... NO (sslv3 alert handshake failure)
Testing ADH-AES128-SHA... NO (sslv3 alert handshake failure)
Testing ADH-SEED-SHA... NO (sslv3 alert handshake failure)
Testing ADH-CAMELLIA128-SHA... NO (sslv3 alert handshake failure)
Testing ECDH-RSA-AES128-GCM-SHA256... NO (sslv3 alert handshake failure)
Testing ECDH-ECDSA-AES128-GCM-SHA256... NO (sslv3 alert handshake failure)
Testing ECDH-RSA-AES128-SHA256... NO (sslv3 alert handshake failure)
Testing ECDH-ECDSA-AES128-SHA256... NO (sslv3 alert handshake failure)
Testing ECDH-RSA-AES128-SHA... NO (sslv3 alert handshake failure)
Testing ECDH-ECDSA-AES128-SHA... NO (sslv3 alert handshake failure)
Testing AES128-GCM-SHA256... NO (sslv3 alert handshake failure)
Testing AES128-SHA256... NO (sslv3 alert handshake failure)
Testing AES128-SHA... NO (sslv3 alert handshake failure)
Testing SEED-SHA... NO (sslv3 alert handshake failure)
Testing CAMELLIA128-SHA... NO (sslv3 alert handshake failure)
Testing PSK-AES128-CBC-SHA... NO (no ciphers available)
Testing ECDHE-RSA-DES-CBC3-SHA... NO (sslv3 alert handshake failure)
Testing ECDHE-ECDSA-DES-CBC3-SHA... NO (sslv3 alert handshake failure)
Testing EDH-RSA-DES-CBC3-SHA... NO (sslv3 alert handshake failure)
Testing EDH-DSS-DES-CBC3-SHA... NO (sslv3 alert handshake failure)
Testing DH-RSA-DES-CBC3-SHA... NO (sslv3 alert handshake failure)
Testing DH-DSS-DES-CBC3-SHA... NO (sslv3 alert handshake failure)
Testing AECDH-DES-CBC3-SHA... NO (sslv3 alert handshake failure)
Testing ADH-DES-CBC3-SHA... NO (sslv3 alert handshake failure)
Testing ECDH-RSA-DES-CBC3-SHA... NO (sslv3 alert handshake failure)
Testing ECDH-ECDSA-DES-CBC3-SHA... NO (sslv3 alert handshake failure)
Testing DES-CBC3-SHA... NO (sslv3 alert handshake failure)
Testing IDEA-CBC-SHA... NO (sslv3 alert handshake failure)
Testing PSK-3DES-EDE-CBC-SHA... NO (no ciphers available)
Testing KRB5-IDEA-CBC-SHA... NO (no ciphers available)
Testing KRB5-DES-CBC3-SHA... NO (no ciphers available)
Testing KRB5-IDEA-CBC-MD5... NO (no ciphers available)
Testing KRB5-DES-CBC3-MD5... NO (no ciphers available)
Testing ECDHE-RSA-RC4-SHA... NO (sslv3 alert handshake failure)
Testing ECDHE-ECDSA-RC4-SHA... NO (sslv3 alert handshake failure)
Testing AECDH-RC4-SHA... NO (sslv3 alert handshake failure)
Testing ADH-RC4-MD5... NO (sslv3 alert handshake failure)
Testing ECDH-RSA-RC4-SHA... NO (sslv3 alert handshake failure)
Testing ECDH-ECDSA-RC4-SHA... NO (sslv3 alert handshake failure)
Testing RC4-SHA... NO (sslv3 alert handshake failure)
Testing RC4-MD5... NO (sslv3 alert handshake failure)
Testing PSK-RC4-SHA... NO (no ciphers available)
Testing KRB5-RC4-SHA... NO (no ciphers available)
Testing KRB5-RC4-MD5... NO (no ciphers available)
Testing ECDHE-RSA-NULL-SHA... NO (sslv3 alert handshake failure)
Testing ECDHE-ECDSA-NULL-SHA... NO (sslv3 alert handshake failure)
Testing AECDH-NULL-SHA... NO (sslv3 alert handshake failure)
Testing ECDH-RSA-NULL-SHA... NO (sslv3 alert handshake failure)
Testing ECDH-ECDSA-NULL-SHA... NO (sslv3 alert handshake failure)
Testing NULL-SHA256... NO (sslv3 alert handshake failure)
Testing NULL-SHA... NO (sslv3 alert handshake failure)
Testing NULL-MD5... NO (sslv3 alert handshake failure)


Testing suites: SSLv3, TLSv1, TLSv1.1, TLSv1.2
Testing ssl3... NO (wrong version number)
Testing tls1... NO (wrong version number)
Testing tls1_1... NO (sslv3 alert handshake failure)
Testing tls1_2... YES


Tests complete!
```
